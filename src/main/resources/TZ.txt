+ 0. Массив индексов дел постоянного хранения  расположен \\hawk\Working\Dela_post_hranenia.work

+ 1. Создать очередную версию ПИ КОНВЕРТЕР -  обозначить в имени запускающего файла и в интерфейсе, что это версия для конвертирования ДЕЛ ПОСТОЯННОГО ХРАНЕНИЯ
	
+ 2. Конвертер должен формировать XLS файл(файлы) и сохранять их в туже папку где лежит mdb!

+ 3.1. Конвертер должен уметь работать с mdb в 3-х режимах: 
+ 1) название режима в ЭФ - "формировать XLS файл для одного тома дела" 
+	запускаем конвертер, указываем режим, вводим значение \Delo\ID, формируем имя XLS файла  по существующим правилам
+ 2) название режима в ЭФ - "формировать XLS файлы с томами по  делу для указанного года"
	- запускаем конвертер, указываем режим, указываем год, формируем  XLS файлы, формируем имя XLS файла  по существующим правилам
	- в один XLS файл собираем все тома (все \Delo\ID) для указанного года (\Delo\Date_start) и тождественным \Delo\Case_number
+ 3) название режима в ЭФ - "формировать XLS файлы с делами по подразделению для указанного года"
	- запускаем конвертер, указываем режим, указываем год, формируем  XLS файлы,  формируем имя XLS файла  по существующим правилам
	- в один XLS файл собираем все тома (все \Delo\ID) для указанного года \Delo\Date_start и различными \Delo\Case_number, имеющими одинаковое начало, т.е. без последнего числа 

+ 3.2. В mdb, в записи о деле лежит ссылка на файл, содержащий графический образ обложки бумажного архивного дела (поле \Delo\Graph_delo). При формировании для файла xls сведений о документах дела  нужно сформировать запись о документе (и положить её  первой на лист с документами) со следующими реквизитами:
	* № регистрации = \Delo\case_number
	* Дата регистрации = \Delo\Date_end
	* Краткое содержание = "Сканобраз обложки бумажного дела" 
	* Количество листов =  "1" 
	* Файлы =  \Delo\Graph_delo 
	* Наименование вида = "Сканобраз обложки бумажного дела"
Запись о документе должна присутствовать только, если  в \Delo\Graph_delo  есть прикрепленный файл.
При подсчете количества листов в последующих документах дела, этот документ не учитывать. 

+ 3.3. Если в mdb, в записи о документе, лежит ссылка на файл, содержащий графический образ внутренней описи бумажного архивного дела (поле \Document\Doc_type = Внутренняя опись), то  нужно сформировать запись о документе  (и положить её  первой на лист с документами (если не формировали "Сканобраз обложки бумажного дела") или второй (если формировали "Сканобраз обложки бумажного дела") со следующими реквизитами:
	* № регистрации = \Delo\case_number+"том"+\Delo\Number_tom
	* Дата регистрации = \Delo\Date_end
	* Краткое содержание = "Внутренняя опись" 
	* Количество листов =  "1" 
	* Файлы =  \Document\Graph 
	* Наименование вида = "Внутренняя опись"
При подсчете количества листов в последующих документах дела, этот документ не учитывать.

+ 3.4. Если в mdb, в записи о документе, лежит ссылка на файл, содержащий графический образ листа заверителя из бумажного архивного дела (поле \Document\Doc_type = Лист-заверитель), то  нужно сформировать запись о документе  (и положить её  последней на лист с документами) со следующими реквизитами:
	* № регистрации = \Delo\case_number+" том "+\Delo\Number_tom
	* Дата регистрации = \Delo\Date_end
	* Краткое содержание = "Лист-заверитель" 
	* Количество листов =  "1" 
	* Файлы =  \Document\Graph 
	* Наименование вида = "Лист-заверитель"

+ 3.5. Правила работы со сведениями о деле (\Delo\ID)
+ 1) Сведения всегда формируем на первом листе XLS файла
+ 2) Если в XLS файл должно быть сформировано более одной записи о \Delo\ID, то складываем их всегда на 1-ый лист в порядке, тождественном порядку расположения в mdb файле
+ 3) В XLS файл формируем:
	+ Индекс дела = \Delo\case_number
	+ Заголовок дела = \Delo\Delo_title
	+ № тома = \Delo\Number_tom
	+ Дата дела с = \Delo\Date_start
	+ Дата дела  по = \Delo\Date_end
+ 4) Если в mdb для Дела  отсутствуют сведения хотя бы в одном из нижепредставленных полей, то сведения в XLS о нем (Деле и его документах) не формировать, а сложить в ЛОГ-файл (какие сведения о Деле класть в ЛОГ-файл - на рассмотрение разработчика - главное чтоб мы потом могли эти сведения в mdb идентифицировать и использовать  для повторной конвертации, п.3.1.1))
	* \Delo\case_number
	* \Delo\Date_start
	* \Delo\Date_end
	* \Delo\Delo_title
	* \Delo\Number_tom

3.6. Правила работы со сведениями о документе дела (\Document\ID1) 
+ 0) ВАЖНО!!! В MDB реквизит \Document\ID_main хранит в себе ID документа - родителя
+ 1) Сведения о документах дела формируем на отдельном листе xls
+ 2) Документы одного дела   располагаем в порядке, тождественном порядку расположения их в mdb файле
+ 3) Если XLS файл содержит сведения более чем об одном деле, то  xls - листы со сведениями о документах дела, располагаем в соответствии с последовательностью расположения записей о деле
+ 4) 
	- если \Document\doc_number = is Null И \Document\ID_main = is not Null, то \Document\doc_number = "к "+"\Document\doc_number" (из документа родителя = \Document\ID_main)
	- если \Document\doc_number = is Null И \Document\ID_main = is  Null, то \Document\doc_number = "без №"
+ 5)
	- если \Document\Date_doc = is Null И \Document\ID_main = is not Null, то \Document\Date_doc = \Document\Date_doc (из документа родителя = \Document\ID_main)
	- если \Document\Date_doc = is Null И \Document\ID_main = is  Null, то \Document\Date_doc = \Delo\Date_end
+ 6)
- если \Document\doc_title = is Null И \Document\ID_main = is not Null, то \Document\doc_title = "\Document\Doc_type"+" к "+ _(остальные значения берем из документа родителя = \Document\ID_main)_"\Document\Doc_type"+" №"+"\Document\doc_number"+" от "+"\Document\Date_doc" 
- если \Document\doc_title = is Null И \Document\ID_main = is  Null, то \Document\doc_title = "\Document\Doc_type"+" в деле "+"\Delo\Delo_title"

+ 7)запись о документе в XLS - листе формируем: 
		№ регистрации = \Document\doc_number
		Дата регистрации = \Document\Date_doc
		Краткое содержание = \Document\doc_title
		Количество листов  = см. правило из пункта 8)
		Файлы =  \Document\Graph

+ 8) 
	- если \Document\Page_s = is Null, то Количество листов = 1
	- если \Document\Page_s = is not Null и  \Document\Page_s (следующего документа дела в mdb) = is not Null, то Количество листов = (\Document\Page_s (следующего документа дела в mdb ) минус \Document\Page_s (текущего документа дела))
	- если \Document\Page_s = is not Null и  \Document\Page_s (следующего документа дела в mdb) = is  Null, то Количество листов = 1
	- для последнего документа дела Количество листов = 1

+ 3.7. Предоставить возможность сохранения всех ЛОГов (которые сейчас отображаются в ходе работы конвертера) в ЛОГ-файл. Возможность сохранения предоставить  по окончании работы конвертера. (если не трудозатратно)
